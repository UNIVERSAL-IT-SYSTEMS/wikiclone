This is a guide for upgrading from GNOME 2.32.x or 3.4.x to GNOME 3.6.x
== Introduction ==


=== General changes ===

Please see the [http://library.gnome.org/misc/release-notes/3.6/ GNOME 3.6 Release Notes] for what is new in this major release of GNOME. 

Current users of GNOME 2 would also want to glance at the release notes for [http://library.gnome.org/misc/release-notes/3.0/ 3.0] , [http://library.gnome.org/misc/release-notes/3.0/ 3.2] , and [http://library.gnome.org/misc/release-notes/3.0/ 3.4] . Briefly: GNOME 3 includes two desktop modes—standard and fallback. Fallback mode uses <code>gnome-base/gnome-panel</code> and <code>x11-wm/metacity</code> , and is similar in appearance and behavior to GNOME 2. Standard mode uses <code>gnome-base/gnome-shell</code> and <code>x11-wm/mutter</code> , and looks and behaves ''completely'' differently from GNOME 2 releases. By default, the choice of desktop mode is determined by the system's graphics hardware and drivers (standard mode requires modern 3D graphics capabilities). 

There is a [https://live.gnome.org/GnomeShell/Tour quick tour] of standard mode's GNOME Shell available on the GNOME website. For an in-depth guide to using GNOME Shell, see [https://live.gnome.org/GnomeShell/CheatSheet the GNOME Shell cheat sheet] . GNOME Shell at first may feel alien and limited to an experienced GNOME 2 user. We strongly encourage users to persist and make themselves use it for a few days; those who take the time to get used to GNOME Shell's behavior usually grow to love it and don't want to go back to a GNOME 2-like desktop environment. 


== Changes affecting current GNOME 3.4 or GNOME 2 users ==


=== Keyboard layouts and input methods ===

GNOME 3.6 does not use traditional <code>xorg.conf</code> keyboard layout settings. Instead, keyboard layouts and input methods are configured via <code>ibus</code> which is integrated into GNOME Shell. 

To add a keyboard layout, open System Settings (or {{Path|gnome-control-center}} from the terminal) and go to ''Region & Language → Input Sources'' . 

Unfortunately, in GNOME 3.6 the System Settings GUI does not allow setting the usual shortcuts (e.g. <code>Alt Shift</code> ) for switching keyboard layouts. Users who use multiple keyboard layouts and need to switch between them from the keyboard will need to use <code>gnome-tweak-tool</code> and select their desired shortcut from the ''Typing → Modifiers-only input sources switcher shortcut'' menu. Alternatively, from a terminal: 



{{Code|Use left Alt Shift to switch between keyboard layouts|<pre>
$ gsettings set org.gnome.settings-daemon.peripherals.keyboard input-sources-switcher alt-shift-l
</pre>
}}



=== Suspend menu item ===

GNOME Shell 3.6 (unlike earlier GNOME 3 releases) always shows a ''Power Off'' menu item by default in the upper-right corner menu. However (unlike earlier GNOME releases) it now [http://library.gnome.org/misc/release-notes/3.6/users-user-menu.html.en no longer shows a Suspend menu item] by default. The ''Suspend'' menu item becomes visible after clicking on the upper right corner menu and holding down the <code>Alt</code> key. Laptops can also be suspended simply by shutting the lid. 

If you need an easily discoverable GUI for suspending the machine, you can install the alternative-status-menu extension. To do so, emerge <code>gnome-extra/gnome-shell-extensions</code> and run 



{{Code|Enabling the alternative-status-menu extension|<pre> 
# eselect gnome-shell-extensions enable 'alternative-status-menu@gnome-shell-extensions.gnome.org'
</pre>
}}

to enable the extension for all users by default, or use <code>gnome-tweak-tool</code> ( ''Shell Extensions'' tab) to enable it on a per-user basis. 



=== Evolution 3.6 plugins ===

Current versions of <code>evolution-exchange</code> and <code>evolution-groupwise</code> are incompatible with Evolution 3.6, and you will need to uninstall them before upgrading to GNOME 3.6. Users of <code>evolution-exchange</code> should try switching to <code>evolution-ews</code> as <code>evolution-exchange</code> development is abandonned. 



=== Interaction with tabs ===

Since Gnome 3.0, some applications stopped switching tabs when scolling over them. This is behavior is intended by upstream actually covers at least <code>app-editors/gedit</code> , <code>gnome-base/nautilus</code> and <code>www-client/epiphany</code> . This behavior will not be patched by Gentoo Gnome team so if you find it annoying, please report directly at [http://bugzilla.gnome.org Gnome bugzilla] . 



=== Interaction with windows ===

If you were used to move and resize windows using <code>Alt + middle click</code> , Gnome 3.6 replaced the <code>Alt</code> key with the <code>Super</code> (Windows Logo) key. If you wish to change back to the old behavior, this can be done using <code>gnome-tweak-tool</code> ( ''Windows'' tab), or from the terminal: 



{{Code|set Alt as modifier key for window interaction|<pre>
$ gsettings set org.gnome.desktop.wm.preferences mouse-button-modifier '<Alt>'
</pre>
}}



=== Logs of the session ===

If you were used to find the logs of the current session in <code>~/.xsession-errors</code> , the file has now moved to XDG compliant location: <code>~/.cache/gdm/session.log</code> . 


== Changes affecting current GNOME 2 users ==


=== Languages and encodings ===

GNOME 3 obtains user language settings from <code>sys-apps/accountsservice</code> . The language can be set in GNOME from the ''My Account'' entry in the upper right corner menu. Alternatively, you can directly edit AccountsService user files. For example, to have user <code>jrandom</code> use British English, you can (as root) edit {{Path|/var/lib/AccountsService/users/jrandom}} so it reads the following: 



{{Code|Simple example of an AccountsService user file|<pre>
[User]
Language=en_GB.utf8
</pre>
}}



=== Fonts ===

GNOME 3 uses <code>media-fonts/cantarell</code> as its default font. Unfortunately, Cantarell currently only includes a subset of Latin and Cyrillic characters. Users of languages with alphabetic writing systems which are not yet covered by Cantarell will probably want to switch to another font, such as <code>media-fonts/dejavu</code> . This can be done using <code>gnome-tweak-tool</code> ( ''Fonts'' tab), or from the terminal: 



{{Code|Set DejaVu (size 10) as the default font|<pre>
$ gsettings set org.gnome.desktop.interface font-name 'DejaVu Sans 10'
$ gsettings set org.gnome.desktop.interface document-font-name 'DejaVu Sans 10'
$ gconftool-2 -s -t string /apps/metacity/general/titlebar_font 'DejaVu Sans Bold 10'
</pre>
}}



=== Applets ===

GNOME 2 applets cannot be used in GNOME 3. Fallback mode allows applets, although some have not yet been ported to the new, gtk3-based APIs. In standard mode, there are no applets at all. Some traditional applet functionality can be replicated using third-party GNOME Shell extensions. 

In order to manage fallback gnome-panel settings (either add/remove or rearrange applet positions) one has to hold down the <code>Alt</code> key when clicking on the panel. This opens relevant menu for changing either panel or applet settings. 



=== Suspend on laptop lid close ===

GNOME 3 will, by default, suspend a laptop when the lid is closed. If you do not like this behavior, you can change it via the <code>gnome-tweak-tool</code> GUI ( ''Shell'' tab), or using <code>gsettings</code> from the terminal: 



{{Code|Only turn off the screen when laptop lid is closed on AC power|<pre> 
$ gsettings set org.gnome.settings-daemon.plugins.power lid-close-ac-action blank
</pre>
}}

One of the most common reasons for not wanting to suspend on laptop lid close is to carry a laptop to another room without losing the network connection. To do so, you can install <code>gnome-extra/office-runner</code> , which allows temporarily inhibiting GNOME's suspend-on-lid-close behavior for up to 10 minutes. 



=== Icons on the desktop ===

In GNOME 3, Nautilus by default no longer manages the desktop, and the {{Path|~/Desktop}} folder is simply treated as a normal folder with files. 

If you want to have Nautilus manage the desktop like in GNOME 2, you can change the corresponding setting in the <code>gnome-tweak-tool</code> GUI ( ''Desktop'' tab), or use the <code>gsettings</code> command from the terminal: 



{{Code|Making Nautilus manage the desktop|<pre> 
$ gsettings set org.gnome.desktop.background show-desktop-icons true
</pre>
}}



=== Compiz ===

GNOME 3 standard mode (i.e. GNOME Shell) is incompatible with Compiz. 



=== PulseAudio ===

GNOME 3 requires <code>media-sound/pulseaudio</code> for audio support. Ensure that you have the <code>pulseaudio</code> USE flag enabled globally (it will be enabled by default if you use the <code>desktop/gnome</code> portage profile). For troubleshooting PulseAudio problems, see [http://www.pulseaudio.org/wiki/Documentation documentation on pulseaudio.org] . 



=== Touchpad and other input device customization ===

In GNOME 3.6, if you have "disable touchpad while typing" selected, the touchpad will be disabled for 1 second after a keyboard key is pressed. In GNOME 2, this interval was 500 milliseconds. If you like to disable the touchpad while typing, but prefer the shorter timeout interval like in GNOME 2, you can emerge <code>gnome-base/gnome-settings-daemon</code> with the <code>short-touchpad-timeout</code> USE flag enabled. 

GNOME 3 allows setting a custom command for advanced customization of input device settings. For example, suppose that you want to configure your touchpad to enable two-finger scrolling (both vertical and horizontal) ''and'' edge scrolling (vertical only). You could do 



{{Code|Setting a new GNOME input device hotplug script|<pre> 
$ cp /usr/share/gnome-settings-daemon-3.0/input-device-example.sh ~/input-device.sh
$ chmod +x ~/input-device.sh
$ gsettings set org.gnome.settings-daemon.peripherals.input-devices hotplug-command ~/input-device.sh
</pre>
}}

and edit {{Path|input-device.sh}} so it ends as follows: 



{{Code||<pre>
# If the device is a touchpad ...
if [[ -z "${device#*TouchPad*}" ]]; then
	# ... enable two-finger scrolling (vertical and horizontal) ...
	xinput set-prop "${device}" "Synaptics Two-Finger Scrolling" 1 1
	# ... and edge scrolling (vertical only, no horizontal, no coasting) ...
	xinput set-prop "${device}" "Synaptics Edge Scrolling" 1 0 0
fi
# All further processing will be disabled if $retval == 0
exit $retval
</pre>
}}


{{Note|If the custom hotplug command does not terminate with exit value 0, <code>gnome-settings-daemon</code> will set its own settings on the input device, likely clobbering the settings that the hotplug command had changed.}}
If, for whatever reason, you want to completely prevent GNOME 3 from automatically modifying your mouse and touchpad settings (note that this will ''also'' prevent custom input hotplug commands, such as {{Path|input-device.sh}} above, from modifying mice and touchpads!), you can run the following: 



{{Code|Prevent GNOME from managing the mouse and touchpad|<pre>
$ gsettings set org.gnome.settings-daemon.plugins.mouse active false
</pre>
}}



=== General configurability and extensions ===

GNOME 3 is designed to appear significantly less configurable than GNOME 2. For example, by default there is no easily discoverable GUI for changing the Gtk+ theme. Many configuration settings are hidden, but can still be changed using the <code>gnome-extra/gnome-tweak-tool</code> GUI, or from gsettings (can be explored using <code>dconf-editor</code> , part of <code>gnome-base/dconf</code> ) or gconf (can be explored using <code>gnome-extra/gconf-editor</code> ). Discussion of most of these settings is outside the scope of this guide. 

GNOME Shell's behavior can be significantly altered using [https://live.gnome.org/GnomeShell/Extensions extensions] . Gentoo packages the extensions from the official GNOME repository as <code>gnome-extra/gnome-shell-extensions</code> . GNOME Shell comes with a browser plugin that allows users to install extensions from the [http://www.gentoo.org/ https://extensions.gnome.org/] web interface; there are also numerous developers publishing extensions on various third-party websites. 

Gentoo uses <code>eselect gnome-shell-extensions</code> to manage system defaults that control whether extensions that were installed systemwide (i.e. in {{Path|/usr/share/gnome-shell/extensions}} ) should be enabled. Newly-installed systemwide extensions start out disabled by default. 



{{Code|Enabling alternative status menu and dock extensions by default for all users|<pre>
# eselect gnome-shell-extensions enable \
  alternative-status-menu@gnome-shell-extensions.gnome.org dock@gnome-shell-extensions.gnome.org
</pre>
}}

Defaults managed by <code>eselect gnome-shell-extensions</code> can be overridden on a per-user basis using the [https://extensions.gnome.org/ extensions.gnome.org] web interface, via <code>gnome-tweak-tool</code> ( ''Shell Extensions'' tab), or from the command line using <code>gsettings</code> . For example, to load the alternative status menu and dock extensions, and disabling all other extensions, a user can run 



{{Code|Enabling alternative status menu and dock extensions (and disabling all others!) for the current user|<pre>
$ gsettings set org.gnome.shell enabled-extensions \
  '["alternative-status-menu@gnome-shell-extensions.gnome.org", "dock@gnome-shell-extensions.gnome.org"]'
</pre>
}}


{{Important|Extension code quality is highly variable. Some extensions contain memory leaks and others can render GNOME completely unusable. Gentoo cannot offer support for problems caused by third-party extensions.}}

== Acknowledgements ==

We would like to thank the following authors and editors for their contributions to this guide:

* tetromino
* eva
